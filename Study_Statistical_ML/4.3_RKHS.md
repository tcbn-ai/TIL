---
marp: true
theme: default
header: ''
footer: 'Kosuke Toda ([@SeeKT](https://github.com/SeeKT))'

size: 16:9
---
<!-- paginate: true -->
# カーネル法の基礎 4.3節
#### 参考文献
- [金森, 統計的学習理論, 講談社, 2015.](https://www.amazon.co.jp/%E7%B5%B1%E8%A8%88%E7%9A%84%E5%AD%A6%E7%BF%92%E7%90%86%E8%AB%96-%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%83%97%E3%83%AD%E3%83%95%E3%82%A7%E3%83%83%E3%82%B7%E3%83%A7%E3%83%8A%E3%83%AB%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-%E9%87%91%E6%A3%AE%E6%95%AC%E6%96%87-ebook/dp/B018K6C9A4)
#### Table of contents
- 再生核Hilbert空間
---

### カーネル関数から生成される内積空間
4.1節の議論を思い出すと，推定量$\hat{f}(x)$はカーネル関数の線形結合で与えられる．
$\rightsquigarrow$ カーネル関数の線形結合で生成される線形空間$\mathcal{H}_0$を定義．
$$
\mathcal{H}_0 = \left\{ \left. f(x) = \sum_{i = 1}^m \alpha_i k(z_i, x) \, \right| \, \alpha_i \in \mathbb{R}, \ z_i \in \mathcal{X}, \ m \in \mathbb{N} \right\} \ \ (4.4)
$$
ここで，$\mathcal{H}_0$は，$\mathcal{X}$上で定義される実数値関数
$$
x \mapsto \sum_{i = 1}^m \alpha_i k(z_i, x)
$$
の集合である．

- $m$が可変
- $z_i$は入力空間の任意の点

---

- 回帰関数や判別関数を学習するアルゴリズムの記述には，$\mathcal{H}_0$を定めておけば十分
- 一般に$\mathcal{H}_0$は完備距離空間とならない．
    - 学習結果の統計的性質を調べるときの収束性の議論が困難になる．

$\mathcal{H}_0$に内積を定義する．$\mathcal{H}_0$上の双線形関数を
$$
\langle k(x_1, \cdot), k(x_2, \cdot) \rangle = k(x_1, x_2), \ x_1, x_2 \in \mathcal{X} \ \ (4.5)
$$
で定める．
- $k(x^{\prime}, \cdot) \in \mathcal{H}_0$ は $x \mapsto k(x^{\prime}, x)$ で定義される$\mathcal{X}$上の関数
    - $x^{\prime} \in \mathcal{X}$: given で，$x \in \mathcal{X}$を与えたときに，$k(x^{\prime}, x)$を返す関数

$\rightsquigarrow$ $\mathcal{X}$上の双線形関数としてwell-definedであることを示す．

---

(4.5)式より，$f = \sum_i \alpha_i k(x_i, \cdot), \ g = \sum_j \beta_j k(x_j, \cdot) \in \mathcal{H}_0$に対して，
$$
\langle f, g \rangle = \sum_i \sum_j \alpha_i \beta_j k(x_i, x_j) = \sum_j f(x_j) \beta_j = \sum_i g(x_i) \alpha_i.
$$

- $\langle f, g \rangle$ の値は関数$f, g$の関数値のみに依存
    - 線形結合の表し方に依存しない

$\rightsquigarrow$ (4.5)に基づいて$\mathcal{H}_0$の双線形関数が定義される．$g = k(x, \cdot)$とおくと，
$$
\langle f, k(x, \cdot) \rangle = f(x), \ f \in \mathcal{H}_0 \ \ (4.6)
$$

- 再生性 (reproducing property)
    - 再生性を用いて，データ点における関数の評価値から内積を計算することができる

---
以下，$\langle f, g \rangle$が$\mathcal{H}_0$上の (実数体における) 内積の公理を満たすことを示す．

線形性と対称性は明らかなので，非負値性と非退化性を示す．

非負値性 ($\langle f, f \rangle \geq 0$)
カーネル関数の定義より，$\alpha \coloneqq (\alpha_1, \ldots, \alpha_n)^{\mathrm{T}}$とおくと，
$$
\langle f, f \rangle = \sum_{i = 1}^n \sum_{j = 1}^n \alpha_i \alpha_j k(x_i, x_j) = \alpha^{\mathrm{T}} K \alpha \geq 0
$$
が示されるので，非負値性が示される．

非退化性 ($\langle f, f \rangle = 0 \Rightarrow f = 0$)
非負値性より，$\forall f, g \in \mathcal{H}_0$ および $\forall t \in \mathbb{R}$に対して，
$$
\langle f + tg, f + tg \rangle = \langle f, f \rangle + 2t \langle f, g \rangle + t^2 \langle g, g \rangle \geq 0
$$
が成り立つ．

---

$t$の2次式として見ると，判別式からSchwarzの不等式
$$
|\langle f, g \rangle|^2 \leq \langle f, f \rangle \langle g, g \rangle
$$
を得る．よって，$\langle f, f \rangle = 0$のとき，再生性 (4.6) とSchwarzの不等式より，$\forall x \in \mathcal{X}$に対して
$$
|f(x)|^2 = |\langle f, k(x, \cdot) \rangle|^2 \leq \langle f, f \rangle k(x, x) = 0
$$
が成り立つ．よって，$f = 0$である．

- 1つ目の等号: 再生性
- 2つ目の不等号: Schwarz

以上より，$\langle f, g \rangle$が$\mathcal{H}_0$の内積であることが示される．

---

### 内積空間の完備化

$(\mathcal{H}, \| \cdot \|_{\mathcal{H}})$: ノルム空間
$\{f_n\}_{n \in \mathbb{N}} \subset \mathcal{H}$がCauchy列
$\overset{\text{def}}{\Longleftrightarrow}$ $\lim_{n, m \to \infty} \|f_n - f_m\|_{\mathcal{H}} = 0$

完備性
$\overset{\text{def}}{\Longleftrightarrow}$ $\forall \{f_n\}_{n \in \mathbb{N}} \subset \mathcal{H}$: Cauchy列, $\exists f \in \mathcal{H}$, $\lim_{n \to \infty} \| f_n - f \|_{\mathcal{H}} = 0$

完備性をもつノルム空間をBanach空間という．

(4.4)式の$\mathcal{H}_0$は，内積から誘導されるノルムに関して一般に完備ではない．
$\rightsquigarrow$ 完備化という操作により，$\mathcal{H}_0$を稠密に含む完備な内積空間$\mathcal{H}$を構成できる．